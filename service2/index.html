<!DOCTYPE html>
<html>
<head>
  <title>Geolocation and IP Example</title>
</head>
<body>

<div id="geoLocation">Loading location...</div>
<div id="ipAddress">Loading IP address...</div>
<div id="environment">Loading environment...</div>

<script>
const geoLocationElement = document.getElementById("geoLocation");
const environmentElement = document.getElementById("environment");

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else {
    geoLocationElement.innerHTML = "Geolocation is not supported by this browser.";
  }
}

function showPosition(position) {
  geoLocationElement.innerHTML = "Latitude: " + position.coords.latitude +
  "<br>Longitude: " + position.coords.longitude;
}

function getEnvironment() {
  fetch('/environment')
    .then(response => response.text())
    .then(data => {
      environmentElement.innerHTML = "Environment: " + data;
    })
    .catch(error => {
      environmentElement.innerHTML = "Error fetching environment variable.";
    });
}

window.onload = () => {
  getLocation();
  getEnvironment();
};
</script>

<script type="application/javascript">
  function getIP(json) {
    document.getElementById("ipAddress").innerHTML = "My public IP address is: " + json.ip;
  }
</script>

<script type="application/javascript" src="https://ipinfo.io/?format=jsonp&callback=getIP"></script>

</body>
</html>
